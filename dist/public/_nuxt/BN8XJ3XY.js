import{_ as T}from"./CQmQ2-nD.js";import{_ as U}from"./BjJADY5a.js";import{l as Y,R as j,P as p,X as z,m as R,Y as A,c as d,o as r,b as s,w as b,a as o,U as g,n,J as h,t as f,H as E,y as H,N as x,r as L,I as O}from"./CVwvMgBG.js";import{_ as F}from"./B4p64Xk_.js";import{_ as J}from"./C5cbwpr9.js";import{b as P}from"./Bgc-ZZWy.js";import{n as S}from"./CftSbWNE.js";const X={class:"flex gap-2 md:gap-4"},q={class:"flex-shrink-0"},G={class:"flex-grow"},K={class:"text-sm"},Q={key:0,class:"flex items-center gap-4 justify-between mb-1"},W={class:"font-semibold"},Z={key:1},ee=["innerHTML"],te={class:"mt-2 flex items-center gap-4 justify-between"},oe={class:"flex items-center gap-1"},se={class:"text-xs text-muted"},ne={class:"space-y-4"},ie={class:"flex items-center gap-2 justify-end"},ae=Y({__name:"notification-item",props:{notification:{}},emits:["deleted","visible","updated"],setup(k,{emit:N}){const i=k,m=N,v=j(),a=p(!1),c=p(!1);z(()=>i.notification,()=>c.value=i.notification.checked??!1);const C=e=>{typeof e=="boolean"&&m("updated",i.notification.id,e)},y=R("target"),{stop:$}=P(y,([e],t)=>{e?.isIntersecting&&(m("visible",i.notification.id),t.disconnect())},{threshold:.5}),u=p(!1);async function w(){u.value=!0;try{await $fetch(`/api/user/notifications/${i.notification.id}`,{method:"delete"}),m("deleted",i.notification.id),v.add({color:"success",title:"Done",description:"Notification deleted successfully"})}catch(e){v.add({color:"error",title:"Error",description:S(e).message})}finally{u.value=!1,a.value=!1}}return A(()=>{$()}),(e,t)=>{const D=T,B=U,M=H,_=L,V=F,I=J;return r(),d("div",{ref_key:"target",ref:y},[s(I,{class:O(n(c)?"bg-muted":"")},{default:b(()=>[o("div",X,[o("div",q,[s(D,{modelValue:n(c),"onUpdate:modelValue":[t[0]||(t[0]=l=>g(c)?c.value=l:null),C]},null,8,["modelValue"])]),o("div",G,[o("div",K,[e.notification.isRead?h("",!0):(r(),d("div",Q,[s(B,{size:"sm",color:"success",variant:"soft",label:"New"})])),o("p",W,f(e.notification.title),1),e.notification.bodyType==="string"?(r(),d("p",Z,f(e.notification.body),1)):(r(),d("div",{key:2,innerHTML:e.notification.body},null,8,ee)),o("footer",te,[o("div",oe,[s(M,{name:"lucide:clock",class:"text-muted"}),o("p",se,f(n(x)(e.notification.createdAt,"MMM DD, YYYY"))+" at "+f(n(x)(e.notification.createdAt,"hh:mm aa")),1)]),n(c)?h("",!0):(r(),E(_,{key:0,icon:"lucide-x",size:"sm",color:"error",variant:"soft",loading:n(u),onClick:t[1]||(t[1]=l=>a.value=!0)},null,8,["loading"]))])])]),s(V,{open:n(a),"onUpdate:open":t[3]||(t[3]=l=>g(a)?a.value=l:null),title:"Delete notification"},{body:b(()=>[o("div",ne,[t[4]||(t[4]=o("p",null,"Are you sure you want to delete this notification?",-1)),o("div",ie,[s(_,{label:"Cancel",color:"neutral",variant:"soft",onClick:t[2]||(t[2]=l=>a.value=!1)}),s(_,{label:"Delete",color:"error",onClick:w})])])]),_:1},8,["open"])])]),_:1},8,["class"])],512)}}}),_e=Object.assign(ae,{__name:"NotificationItem"});export{_e as _};

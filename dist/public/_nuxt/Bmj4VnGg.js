import{_ as W}from"./mQEU68Wg.js";import{l as $,R as M,P as v,c as f,o as p,L as V,b as t,r as z,K as O,n as e,T as Y,q as G,S as H,w as u,a as r,J as T,d as J,W as K,t as D,U as F,H as L,y as Q}from"./BCrY3s8v.js";import{_ as X}from"./CidxsHgk.js";import{_ as Z}from"./A1aqh1bs.js";import{a as ee,_ as te}from"./Bkd0wxOE.js";import{_ as oe}from"./CSISanO2.js";import{_ as ne}from"./CwNR5WVR.js";import{n as R}from"./wc51SthY.js";import{_ as ae}from"./noFtHZsG.js";import{_ as se}from"./CtsDBDzy.js";import{_ as le}from"./CqYo-uwL.js";import{t as y}from"./ChRclvJ-.js";import{z as B}from"./BoqIIjWt.js";import{u as re}from"./mHVIAYtm.js";import{_ as ie}from"./BA4GzNlT.js";import"./ByvhOd8C.js";import"./Df43cr2Y.js";import"./8tY1C0Fy.js";import"./DSCz-RR9.js";import"./CpLtEdiG.js";import"./CtXVfFFE.js";import"./YE4bf-b6.js";import"./ZB12-UxD.js";import"./1c9ch5oL.js";import"./CAqHKxSD.js";import"./BsY6ekDi.js";import"./jFYhBC76.js";import"./CHIgUVhi.js";import"./IDdVFqQ_.js";import"./CZ2Yaa7T.js";import"./Bar4WUZu.js";const ce=$({__name:"deposit-creator",props:{transaction:{},buttonProps:{default:()=>({size:"lg",label:"Submit"})}},setup(i){const n=M(),m=v(!1),o=v(null),b=async()=>{o.value=null,m.value=!0;try{const c=await $fetch("/api/user/transactions/deposit",{method:"POST",body:i.transaction});n.add({color:"success",title:"Success",description:c.message}),setTimeout(()=>{Y(`/user/accounts/${i.transaction.financialAccountId}/transactions`)},2e3)}catch(c){o.value=R(c),n.add({color:"error",title:o.value.name??"Eror",description:o.value.message})}finally{m.value=!1}};return(c,w)=>{const a=z;return p(),f("div",{class:"w-full cursor-pointer",onClick:b},[V(c.$slots,"default",{},()=>[t(a,O(c.buttonProps,{loading:e(m)}),null,16,["loading"])])])}}}),ue=Object.assign(ce,{__name:"UserDepositCreator"}),me=$({__name:"text-copy-button",props:{text:{default:""},resetAfter:{default:3e3},color:{default:"neutral"},variant:{default:"soft"},size:{default:"lg"},icon:{default:"lucide:clipboard"},label:{default:()=>{}}},setup(i){const n=v(i.icon),m=async()=>{if(navigator)try{await navigator.clipboard.writeText(String(i.text)),n.value="lucide-circle-check",setTimeout(()=>{n.value=i.icon},i.resetAfter)}catch(o){console.error(o),n.value="lucide-circle-x",setTimeout(()=>{n.value=i.icon},i.resetAfter)}};return(o,b)=>{const c=z;return V(o.$slots,"default",{copy:m},()=>[t(c,{color:o.color,size:o.size,variant:o.variant,label:o.label,icon:e(n),onClick:m},null,8,["color","size","variant","label","icon"])])}}}),de=Object.assign(me,{__name:"TextCopyButton"}),pe={class:"space-y-4"},fe={key:0},_e={key:0},ye={key:0,class:"space-y-4"},ve={class:"flex-col-center gap-1"},be={class:"text-center text-3xl font-semibold font-geist-mono"},ge={class:"text-sm text-center"},xe={class:"flex gap-2 justify-end"},he={key:1,class:"space-y-4"},we={class:"flex-col-center gap-1"},De={class:"text-center text-3xl font-semibold font-geist-mono"},$e={class:"grid grid-cols-2 gap-4"},Ae={class:"flex gap-2 justify-end"},Se=$({__name:"deposit-form",props:{currency:{}},setup(i){const{minDepositAmount:n,maxDepositAmount:m}=G().public,o=re().getParams("accountId"),b=B.object({amount:B.number({message:"Amount is required"}).min(n,{message:`Amount must be at least ${y(n)}`}).max(m,{message:`Amount must not be more than ${y(m)}`})}),c=H({amount:0}),w=()=>{c.amount=0},a=v(null),d=v(!1),A=v(null),E=async s=>{const{amount:l}=s.data;if(i.currency.symbol==="WIRE"){a.value={financialAccountId:o,amount:l/(i.currency.rate??1),currency:"USD",USDAmount:l,rate:i.currency.rate,type:"deposit"},d.value=!0;return}try{const _=await $fetch("/api/user/transactions/init-deposit",{query:{symbol:i.currency.symbol,amount:l}});a.value={financialAccountId:o,amount:_.currencyDepositAmount,currency:_.currency.symbol,USDAmount:l,rate:_.currency.rate,type:"deposit"},d.value=!0,w()}catch(_){A.value=R(_)}};return(s,l)=>{const _=X,P=Z,g=ee,S=z,j=te,C=oe,U=ne,I=ue,x=ae,k=de,N=se,q=le;return p(),f("div",null,[t(j,{state:e(c),schema:e(b),onSubmit:K(E,["prevent"])},{default:u(()=>[r("div",pe,[e(A)?(p(),f("div",fe,[t(_,{message:e(A).message},null,8,["message"])])):T("",!0),t(g,{name:"amount",label:"Enter the deposit amount",description:`Min: ${("toDollar"in s?s.toDollar:e(y))(e(n))} Max: ${("toDollar"in s?s.toDollar:e(y))(e(m))}`},{default:u(()=>[t(P,{modelValue:e(c).amount,"onUpdate:modelValue":l[0]||(l[0]=h=>e(c).amount=h),"step-snapping":!1,"format-options":{style:"currency",currency:"USD",currencyDisplay:"symbol",currencySign:"standard",minimumFractionDigits:2,maximumFractionDigits:2},min:e(n),max:e(m),size:"lg",class:"w-full"},null,8,["modelValue","min","max"])]),_:1},8,["description"]),t(S,{type:"submit",class:"mt-2",size:"lg",icon:"i-lucide-check-circle","loading-auto":""},{default:u(()=>l[4]||(l[4]=[J(" Submit ")])),_:1,__:[4]})])]),_:1},8,["state","schema"]),t(q,{open:e(d),"onUpdate:open":l[3]||(l[3]=h=>F(d)?d.value=h:null),dismissible:!1,title:"Deposit Request",description:"Review the details of your deposit request."},{body:u(()=>[e(a)?(p(),f("div",_e,[s.currency.symbol==="WIRE"?(p(),f("div",ye,[r("header",ve,[l[5]||(l[5]=r("p",{class:"card-title"},"Amount",-1)),r("h3",be,D(("toDollar"in s?s.toDollar:e(y))(e(a).USDAmount)),1),t(C,{label:s.currency.name,variant:"soft"},null,8,["label"])]),r("p",ge," You are about to make a deposit of "+D(("toDollar"in s?s.toDollar:e(y))(e(a).USDAmount))+" via wire transfer. ",1),t(U,{variant:"soft",description:"The deposit account details will be sent to your email address, and your account will be credited once the deposit has been confirmed."}),r("div",xe,[t(S,{label:"Cancel",color:"neutral",variant:"soft",size:"lg",icon:"lucide-circle-x",onClick:l[1]||(l[1]=h=>d.value=!1)}),t(I,{transaction:e(a),"button-props":{size:"lg",label:"Proceed",trailingIcon:"i-lucide-circle-arrow-right"}},null,8,["transaction"])])])):(p(),f("div",he,[r("header",we,[l[6]||(l[6]=r("p",{class:"card-title"},"Amount",-1)),r("h3",De,D(("toDollar"in s?s.toDollar:e(y))(e(a).USDAmount)),1),t(C,{label:s.currency.name,variant:"soft"},null,8,["label"])]),r("div",$e,[t(g,{label:"Currency"},{default:u(()=>[t(x,{value:e(a).currency,readonly:"",size:"lg",class:"w-full"},null,8,["value"])]),_:1}),t(g,{label:`Rate: 1 ${e(a).currency} to USD`},{default:u(()=>[t(x,{value:e(a).rate,readonly:"",size:"lg",class:"w-full"},null,8,["value"])]),_:1},8,["label"]),t(g,{class:"col-span-2",label:`Deposit amount in ${e(a).currency}`},{default:u(()=>[t(N,{class:"w-full"},{default:u(()=>[t(x,{value:e(a).amount,readonly:"",size:"lg",class:"w-full"},null,8,["value"]),t(k,{text:e(a).amount,variant:"outline"},null,8,["text"])]),_:1})]),_:1},8,["label"])]),t(U,{variant:"soft",description:`Send exactly ${e(a).amount} ${e(a).currency} to the wallet address provided below. Your account will be credited once the deposit has been confirmed.`},null,8,["description"]),t(g,{label:"Wallet address"},{default:u(()=>[t(N,{class:"w-full"},{default:u(()=>[t(x,{value:s.currency.walletAddress,size:"lg",class:"w-full"},null,8,["value"]),t(k,{text:s.currency.walletAddress,variant:"outline"},null,8,["text"])]),_:1})]),_:1}),t(g,{label:"Wallet address network"},{default:u(()=>[t(N,{class:"w-full"},{default:u(()=>[t(x,{value:s.currency.walletAddressNetwork,size:"lg",class:"w-full"},null,8,["value"]),t(k,{text:s.currency.walletAddressNetwork,variant:"outline"},null,8,["text"])]),_:1})]),_:1}),r("div",Ae,[t(S,{label:"Cancel",color:"neutral",variant:"soft",size:"lg",icon:"lucide-circle-x",onClick:l[2]||(l[2]=h=>d.value=!1)}),t(I,{transaction:e(a),"button-props":{size:"lg",label:"Proceed",trailingIcon:"i-lucide-circle-arrow-right"}},null,8,["transaction"])])]))])):T("",!0)]),_:1},8,["open"])])}}}),ke=Object.assign(Se,{__name:"UserDepositForm"}),Ne={class:"w-full h-full md:flex space-x-4 space-y-4 md:space-y-0"},ze={class:"h-full max-h-96 md:max-h-[34rem] md:flex-shrink-0 overflow-y-auto w-full md:w-72 border rounded-md border-muted p-4"},Ce={class:"h-full overflow-y-auto md:flex-grow p-0.5"},Ue={key:0,class:"h-60 fluid flex-col-center gap-4"},Ie={class:"text-xl font-semibold"},ut=$({__name:"deposit",setup(i){const n=v(null);return(m,o)=>{const b=W,c=Q,w=ke,a=ie;return p(),f("div",Ne,[r("div",ze,[o[1]||(o[1]=r("header",{class:"mb-4"},[r("p",{class:"card-title"},"Select medium")],-1)),t(b,{modelValue:e(n),"onUpdate:modelValue":o[0]||(o[0]=d=>F(n)?n.value=d:null)},null,8,["modelValue"])]),r("div",Ce,[e(n)?(p(),L(a,{key:1},{header:u(()=>[r("p",Ie,D(e(n).symbol)+" Deposit ",1)]),default:u(()=>[r("div",null,[t(w,{currency:e(n)},null,8,["currency"])])]),_:1})):(p(),f("div",Ue,[t(c,{name:"lucide-coins",size:"6rem",class:"text-muted"}),o[2]||(o[2]=r("p",{class:"card-title"},"Select a deposit medium",-1))]))])])}}});export{ut as default};

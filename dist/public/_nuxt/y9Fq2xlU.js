import{l as C,R as V,P as _,E as $,S as z,c as u,J as f,b as a,n as t,t as g,w as o,U as F,a as U,o as p,r as B,W as E,d as T}from"./CVwvMgBG.js";import{_ as j}from"./BZPumJrv.js";import{_ as I,a as J}from"./D7s51L10.js";import{_ as P}from"./DlU5MmRb.js";import{z as h}from"./B_lSGf9J.js";import{u as R}from"./CpJRfXdp.js";import{n as q}from"./CftSbWNE.js";const A={class:"w-full space-y-2"},D={key:0,class:"card-title"},M={key:1,class:"mt-6"},O={class:"card-title"},Z=C({__name:"name-changer",setup(W){const r=R(),b=V(),n=_(!1),s=$(()=>r.user.value),v=h.object({name:h.string().min(1,"Name is required")}),l=z({name:""});function x(){l.name=""}const i=_(null);async function w(d){i.value=null;try{const e=await $fetch("/api/user",{method:"PUT",body:JSON.stringify({name:d.data.name}),headers:{"Content-Type":"application/json"}});x(),r.setUser({...r.user.value,name:e.name}),n.value=!1}catch(e){i.value=q(e),b.add({title:"Error",description:i.value.message||"Failed to update name",color:"error"})}}return(d,e)=>{const c=B,y=j,N=J,S=I,k=P;return p(),u("div",A,[t(s)?(p(),u("p",D,g(t(s).name),1)):f("",!0),a(k,{open:t(n),"onUpdate:open":e[1]||(e[1]=m=>F(n)?n.value=m:null),class:"flex flex-col gap-4 w-full"},{content:o(()=>[a(S,{schema:t(v),state:t(l),class:"space-y-3",onSubmit:E(w,["prevent"])},{default:o(()=>[a(N,{label:"Full name",name:"name"},{default:o(()=>[a(y,{modelValue:t(l).name,"onUpdate:modelValue":e[0]||(e[0]=m=>t(l).name=m),size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),a(c,{type:"submit",class:"mt-2 w-full flex-center",size:"lg",icon:"i-lucide-check-circle","loading-auto":""},{default:o(()=>e[2]||(e[2]=[T(" Submit ")])),_:1,__:[2]})]),_:1},8,["schema","state"])]),default:o(()=>[a(c,{class:"group w-full",label:"Change name",color:"neutral",size:"lg",variant:"subtle","trailing-icon":"i-lucide-chevron-down",ui:{trailingIcon:"group-data-[state=open]:rotate-180 transition-transform duration-200"},block:""})]),_:1},8,["open"]),t(s)?(p(),u("div",M,[U("p",O,g(t(s).email),1),a(c,{class:"mt-2 w-full",label:"Change email",color:"neutral",variant:"subtle","trailing-icon":"i-lucide-arrow-up-right",block:"",to:"/user/change-email"})])):f("",!0)])}}});export{Z as _};

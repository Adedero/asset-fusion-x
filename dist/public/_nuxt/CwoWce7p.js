import{l as j,R as E,H as R,o as r,w as d,b as s,r as q,a as e,M as F,n as o,c,J as A,F as x,x as C,V as T,t as v,N}from"./BCrY3s8v.js";import{_ as L}from"./CSISanO2.js";import{_ as O}from"./DUfBocCK.js";import{_ as P}from"./BA4GzNlT.js";import{_ as G}from"./bl0oUpIY.js";import{_ as H}from"./GUhg-1-n.js";import{_ as J}from"./CqYo-uwL.js";import{n as Z}from"./wc51SthY.js";import{u as B}from"./CAqHKxSD.js";import{_ as K}from"./RTrhuSk4.js";import{t as z}from"./-7KF7Ksm.js";import{t as I}from"./ChRclvJ-.js";import{u as Q}from"./DcHTeA6R.js";import{u as W}from"./mHVIAYtm.js";import"./eC20ivXU.js";import"./1c9ch5oL.js";import"./CZ2Yaa7T.js";import"./Bar4WUZu.js";import"./CidxsHgk.js";import"./CwNR5WVR.js";const X={class:"space-y-4"},tt={class:"flex items-center justify-end gap-2"},et=j({__name:"mod-request-status-updater",props:{status:{},accountId:{},modRequestId:{},approvalId:{},buttonLabel:{default:"Accept"},buttonColor:{default:"primary"},buttonVariant:{default:"solid"},buttonSize:{default:"sm"}},emits:["done"],setup(u,{emit:_}){const b=_,f=E(),{error:m,data:h,execute:g}=B(`/api/user/financial-accounts/${u.accountId}/mod-requests/${u.modRequestId}`,{method:"put",immediate:!1,query:{status:u.status,approvalId:u.approvalId}},"$8pU5T_Gm_R"),k=async l=>{if(await g(),h.value){f.add({color:"success",description:h.value.message}),l(),b("done",!0);return}m.value&&(f.add({color:"error",description:Z(m.value).message}),b("done",!1))};return(l,a)=>{const i=q,p=J;return r(),R(p,{title:l.status==="accepted"?"Accept request":"Reject request",dismissible:!1},{body:d(({close:y})=>[e("div",X,[a[0]||(a[0]=e("p",null,"Are you sure you want to proceed? This action cannot be undone",-1)),e("div",tt,[s(i,{color:"neutral",variant:"soft",label:"Cancel",onClick:$=>y()},null,8,["onClick"]),s(i,{label:"Proceed","loading-auto":"",onClick:$=>k(y)},null,8,["onClick"])])])]),default:d(()=>[s(i,{size:l.buttonSize,color:l.buttonColor,variant:l.buttonVariant,label:l.buttonLabel},null,8,["size","color","variant","label"])]),_:1},8,["title"])}}}),ot=Object.assign(et,{__name:"UserModRequestStatusUpdater"});function Y(u){return u==="pending"?"primary":u==="accepted"?"success":"error"}const st={key:0,class:"mb-4 lg:grid lg:grid-cols-2 lg:gap-4"},at={class:"space-y-2"},nt={key:0,class:"space-y-4"},rt={class:"flex items-center gap-2"},it={class:"text-sm text-muted"},lt={class:"mt-2 ml-2 space-y-2"},ct={class:"flex items-center gap-3"},dt={class:"text-sm"},ut={class:"mt-4 flex justify-end"},mt={class:"text-xs"},pt={key:1},_t={class:"space-y-2"},ft={key:0,class:"space-y-4"},vt={class:"flex items-center gap-2"},bt={class:"text-sm text-muted"},gt={class:"mt-2 ml-2 space-y-2"},yt={class:"flex items-center gap-3"},ht={class:"text-sm"},$t={class:"flex justify-between"},xt={class:"text-xs"},Ct={key:0,class:"flex items-center gap-2"},Rt={key:1},Pt=j({__name:"requests",async setup(u){let _,b;const f=W().getParams("accountId"),{data:m,error:h,refresh:g}=([_,b]=F(()=>B(`/api/user/financial-accounts/${f}/mod-requests`,{key:"account-mod-requests"},"$EyT6jpiZcO")),_=await _,b(),_),k=Q();function l(a){return a.approvals.find(p=>p.approver.id===k.user.value?.id)}return(a,i)=>{const p=T,y=q,$=L,D=O,M=P,S=G,U=H,w=ot,V=K;return r(),R(V,{error:o(h),onRefres:i[2]||(i[2]=t=>o(g)())},{default:d(()=>[o(m)?(r(),c("div",st,[e("div",at,[i[3]||(i[3]=e("p",{class:"card-title"},"Your Requests",-1)),o(m).ownRequests.length?(r(),c("div",nt,[(r(!0),c(x,null,C(o(m).ownRequests,t=>(r(),R(M,{key:t.id},{header:d(()=>[e("div",rt,[s(p,{alt:t.creator.name,src:t.creator.image??void 0},null,8,["alt","src"]),e("p",it,v(t.description??`${t.creator.name} initiated a ${("toCase"in a?a.toCase:o(z))(t.type,"lower")} request ${t.transaction?`of ${("toDollar"in a?a.toDollar:o(I))(t.transaction.USDAmount)}`:""}`),1)])]),default:d(()=>[e("div",null,[e("div",null,[s(D,{class:"flex flex-col gap-2"},{content:d(()=>[e("div",lt,[(r(!0),c(x,null,C(t.approvals,n=>(r(),c("div",{key:n.id},[e("div",ct,[s(p,{alt:n.approver.name,src:n.approver.image??void 0},null,8,["alt","src"]),e("p",dt,v(n.approver.name),1),s($,{color:("getModRequestStatusColor"in a?a.getModRequestStatusColor:o(Y))(n.status),label:n.status,size:"sm",variant:"subtle"},null,8,["color","label"])])]))),128))])]),default:d(()=>[s(y,{label:"Approval Status",color:"neutral",variant:"soft","trailing-icon":"i-lucide-chevron-down",block:""})]),_:2},1024)]),e("div",ut,[e("p",mt,v(o(N)(t.createdAt,"MMM DD, YYYY | hh:mm aa")),1)])])]),_:2},1024))),128))])):(r(),c("div",pt,[s(S,{label:"No requests",size:"4rem"})]))]),s(U,{class:"lg:hidden my-8"}),e("div",_t,[i[4]||(i[4]=e("p",{class:"card-title"},"Other Requests",-1)),o(m).otherRequests.length?(r(),c("div",ft,[(r(!0),c(x,null,C(o(m).otherRequests,t=>(r(),R(M,{key:t.id},{header:d(()=>[e("div",vt,[s(p,{alt:t.creator.name,src:t.creator.image??void 0},null,8,["alt","src"]),e("p",bt,v(t.description??`${t.creator.name} initiated a ${("toCase"in a?a.toCase:o(z))(t.type,"lower")} request ${t.transaction?`of ${("toDollar"in a?a.toDollar:o(I))(t.transaction.USDAmount)}`:""}`),1)])]),footer:d(()=>[e("div",$t,[e("p",xt,v(o(N)(t.createdAt,"MMM DD, YYYY | hh:mm aa")),1),l(t)&&l(t)?.status==="pending"?(r(),c("div",Ct,[s(w,{"approval-id":l(t).id,"mod-request-id":t.id,"account-id":o(f),status:"accepted","button-size":"sm","button-label":"Accept",onDone:i[0]||(i[0]=n=>n&&o(g)())},null,8,["approval-id","mod-request-id","account-id"]),s(w,{"approval-id":l(t).id,"mod-request-id":t.id,"account-id":o(f),status:"rejected","button-size":"sm","button-label":"Reject","button-color":"error","button-variant":"subtle",onDone:i[1]||(i[1]=n=>n&&o(g)())},null,8,["approval-id","mod-request-id","account-id"])])):A("",!0)])]),default:d(()=>[e("div",null,[e("div",null,[s(D,{class:"flex flex-col gap-2"},{content:d(()=>[e("div",gt,[(r(!0),c(x,null,C(t.approvals,n=>(r(),c("div",{key:n.id},[e("div",yt,[s(p,{alt:n.approver.name,src:n.approver.image??void 0},null,8,["alt","src"]),e("p",ht,v(n.approver.name),1),s($,{color:("getModRequestStatusColor"in a?a.getModRequestStatusColor:o(Y))(n.status),label:n.status,size:"sm",variant:"subtle"},null,8,["color","label"])])]))),128))])]),default:d(()=>[s(y,{label:"Approval Status",color:"neutral",variant:"soft","trailing-icon":"i-lucide-chevron-down",block:""})]),_:2},1024)])])]),_:2},1024))),128))])):(r(),c("div",Rt,[s(S,{label:"No requests",size:"4rem"})]))])])):A("",!0)]),_:1},8,["error"])}}});export{Pt as default};
